{{- $input := .Get 0 -}}
{{- $videoId := "" -}}

{{/* Извлекаем ID из разных форматов */}}
{{- if findRE "^[a-f0-9]{32}$" $input -}}
    {{- $videoId = $input -}}
{{- else if findRE "rutube\\.ru/video/([a-f0-9]+)" $input -}}
    {{- $videoId = replaceRE ".*rutube\\.ru/video/([a-f0-9]+).*" "$1" $input -}}
{{- else if findRE "rutube\\.ru/play/embed/([a-f0-9]+)" $input -}}
    {{- $videoId = replaceRE ".*rutube\\.ru/play/embed/([a-f0-9]+).*" "$1" $input -}}
{{- end -}}

{{- if $videoId -}}
<div class="video-wrapper">
    <iframe src="https://rutube.ru/play/embed/{{ $videoId }}" 
            scrolling="no" 
            frameborder="no"
            framespacing="0" 
            allowfullscreen="true"
            style="width: 100%; height: 400px; border: none;"
    >
    </iframe>
</div>
{{- else -}}
<p style="color: red; padding: 20px; background: #fee;">
    Ошибка: неверный формат видео Rutube. Используйте ID или полную ссылку.
</p>
{{- end -}}